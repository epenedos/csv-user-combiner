import{r as K,a as Y,g as A}from"./vendor-DavUf6mE.js";import{r as b,U as Q,F as X,a as Z,D as q,A as ee,R as te}from"./lucide-C3qpsj8X.js";import{r as se}from"./papaparse-rDawIJ35.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const x of n.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&f(x)}).observe(document,{childList:!0,subtree:!0});function u(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function f(o){if(o.ep)return;o.ep=!0;const n=u(o);fetch(o.href,n)}})();var P={exports:{}},_={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M;function re(){if(M)return _;M=1;var m=K(),g=Symbol.for("react.element"),u=Symbol.for("react.fragment"),f=Object.prototype.hasOwnProperty,o=m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function x(y,i,C){var c,w={},N=null,D=null;C!==void 0&&(N=""+C),i.key!==void 0&&(N=""+i.key),i.ref!==void 0&&(D=i.ref);for(c in i)f.call(i,c)&&!n.hasOwnProperty(c)&&(w[c]=i[c]);if(y&&y.defaultProps)for(c in i=y.defaultProps,i)w[c]===void 0&&(w[c]=i[c]);return{$$typeof:g,type:y,key:N,ref:D,props:w,_owner:o.current}}return _.Fragment=u,_.jsx=x,_.jsxs=x,_}var I;function ae(){return I||(I=1,P.exports=re()),P.exports}var e=ae(),F={},W;function le(){if(W)return F;W=1;var m=Y();return F.createRoot=m.createRoot,F.hydrateRoot=m.hydrateRoot,F}var oe=le();const ie=A(oe);var ne=se();const v=A(ne),de=()=>{const[m,g]=b.useState([]),[u,f]=b.useState([]),[o,n]=b.useState([]),[x,y]=b.useState(!1),[i,C]=b.useState(null),[c,w]=b.useState(!1),[N,D]=b.useState(!1),G=b.useCallback(t=>{const r=Array.from(t.target.files);g(r),f([]),n([]),C(null)},[]),T=t=>{const r=t==="combined"?v.unparse(u):v.unparse(o.flatMap(s=>s.records.map(a=>({duplicate_name:s.originalName||s.duplicateValue,duplicate_type:"Name",...a}))));navigator.clipboard.writeText(r).then(()=>{alert(`${t==="combined"?"Combined":"Duplicate"} CSV data copied to clipboard!`)}).catch(()=>{alert('Could not copy to clipboard. Try the "Show CSV" option below.')})},J=async()=>{if(m.length===0)return;y(!0);let t=[],r=[];try{for(let l=0;l<m.length;l++){const d=m[l];await new Promise((R,S)=>{v.parse(d,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:h=>{h.errors.length>0&&console.warn(`Errors in ${d.name}:`,h.errors);const O=Object.keys(h.data.length>0?h.data[0]:{}).find(p=>p.toLowerCase()==="type"),V=["Type","Display Name","Name","Domain"],U=h.data.filter(p=>O?String(p[O]).toLowerCase()==="user":!0).map(p=>{const j={};return V.forEach(E=>{const L=Object.keys(p).find(H=>H.toLowerCase()===E.toLowerCase());L?j[E]=p[L]:j[E]=""}),j.__source_file=d.name,j.__file_index=l,j});t=t.concat(U);const k=V.filter(p=>Object.keys(h.data.length>0?h.data[0]:{}).some(j=>j.toLowerCase()===p.toLowerCase()));r.push({fileName:d.name,totalRowCount:h.data.length,userRowCount:U.length,hasTypeField:!!O,availableFields:k,missingFields:V.filter(p=>!k.includes(p)),columns:h.meta.fields||[]}),R()},error:S})})}const s=t.length>0&&t.some(l=>l.Name),a=z(t);f(t),n(a),C({totalRecords:t.length,totalFiles:m.length,fileDetails:r,hasNameField:s,duplicateCount:a.reduce((l,d)=>l+d.records.length,0),duplicateGroups:a.length,totalOriginalRecords:r.reduce((l,d)=>l+d.totalRowCount,0)})}catch(s){console.error("Error processing files:",s)}finally{y(!1)}},z=t=>{const r=[],s="Name";if(!t.some(l=>l[s]))return console.warn('No "Name" field found in the processed data'),[];const a=new Map;return t.forEach((l,d)=>{const R=l[s];if(R&&String(R).trim()!==""){const S=String(R).toLowerCase().trim();a.has(S)||a.set(S,[]),a.get(S).push({...l,__original_index:d})}}),a.forEach((l,d)=>{l.length>1&&r.push({strategy:"Name",duplicateValue:d,records:l,originalName:l[0][s]})}),r},$=()=>{const t=v.unparse(u);try{const r="data:text/csv;charset=utf-8,"+encodeURIComponent(t),s=document.createElement("a");s.href=r,s.download="combined_users.csv",s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}catch{navigator.clipboard.writeText(t).then(()=>{alert("CSV data copied to clipboard! Paste it into a text file and save as .csv")}).catch(()=>{const s=window.open();s.document.write("<pre>"+t+"</pre>"),s.document.title="Combined Users CSV - Copy and Save"})}},B=()=>{const t=o.flatMap(s=>s.records.map(a=>({duplicate_name:s.originalName||s.duplicateValue,duplicate_type:"Name",...a}))),r=v.unparse(t);try{const s="data:text/csv;charset=utf-8,"+encodeURIComponent(r),a=document.createElement("a");a.href=s,a.download="duplicate_names.csv",a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch{navigator.clipboard.writeText(r).then(()=>{alert("Duplicate names CSV data copied to clipboard! Paste it into a text file and save as .csv")}).catch(()=>{const a=window.open();a.document.write("<pre>"+r+"</pre>"),a.document.title="Duplicate Names CSV - Copy and Save"})}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"CSV User Data Combiner & Duplicate Detector"}),e.jsxs("p",{className:"text-gray-600",children:['Upload multiple CSV files containing user data to combine them and identify duplicates based on the "Name" field.',e.jsx("span",{className:"font-medium text-blue-600",children:' Only records with Type = "User" will be processed (if Type field exists).'}),e.jsx("br",{}),e.jsx("span",{className:"font-medium text-purple-600",children:"Only these fields will be extracted: Type, Display Name, Name, Domain"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[e.jsx(Q,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:"Choose CSV Files"}),e.jsx("input",{type:"file",multiple:!0,accept:".csv",onChange:G,className:"hidden"})]})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Select multiple CSV files to process"})]}),m.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Selected Files:"}),e.jsx("div",{className:"space-y-2",children:m.map((t,r)=>e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),t.name," (",(t.size/1024).toFixed(1)," KB)"]},r))}),e.jsx("button",{onClick:J,disabled:x,className:"mt-4 bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 disabled:bg-gray-400 transition-colors",children:x?"Processing...":"Process Files"})]})]}),i&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-900 mb-4 flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 mr-2"}),"Processing Summary"]}),e.jsx("div",{className:"mb-4",children:i.hasNameField?e.jsx("div",{className:"text-sm text-green-600 bg-green-50 border border-green-200 rounded px-3 py-2",children:'✓ Using "Name" field for duplicate detection'}):e.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",children:'⚠ No "Name" field found - duplicate detection disabled'})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:"User Records"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalRecords})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Total Records"}),e.jsx("div",{className:"text-lg font-medium text-gray-600",children:i.totalOriginalRecords})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Files Processed"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalFiles})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Duplicate Records"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.duplicateCount})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-900",children:"Duplicate Groups"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.duplicateGroups})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:$,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Download Combined Data"]}),e.jsx("button",{onClick:()=>T("combined"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Copy Combined CSV"}),e.jsxs("button",{onClick:()=>w(!c),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[c?"Hide":"Show"," Combined CSV"]}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:B,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Download Name Duplicates"]}),e.jsx("button",{onClick:()=>T("duplicates"),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Copy Duplicates CSV"}),e.jsxs("button",{onClick:()=>D(!N),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[N?"Hide":"Show"," Duplicates CSV"]})]})]})]}),c&&e.jsxs("div",{className:"mt-4 bg-gray-50 border border-gray-300 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Combined CSV Data (copy and save as .csv file):"}),e.jsx("textarea",{value:v.unparse(u),readOnly:!0,className:"w-full h-40 text-xs font-mono border border-gray-300 rounded p-2 resize-vertical",onClick:t=>t.target.select()})]}),N&&o.length>0&&e.jsxs("div",{className:"mt-4 bg-gray-50 border border-gray-300 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Duplicates CSV Data (copy and save as .csv file):"}),e.jsx("textarea",{value:v.unparse(o.flatMap(t=>t.records.map(r=>({duplicate_name:t.originalName||t.duplicateValue,duplicate_type:"Name",...r})))),readOnly:!0,className:"w-full h-40 text-xs font-mono border border-gray-300 rounded p-2 resize-vertical",onClick:t=>t.target.select()})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"File Details"}),e.jsx("div",{className:"space-y-3",children:i.fileDetails.map((t,r)=>e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.fileName}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[t.hasTypeField?e.jsxs(e.Fragment,{children:[t.userRowCount," user records (out of ",t.totalRowCount," total)",t.userRowCount<t.totalRowCount&&e.jsxs("span",{className:"text-blue-600 ml-1",children:["• ",t.totalRowCount-t.userRowCount," non-user records filtered out"]})]}):e.jsxs(e.Fragment,{children:[t.userRowCount,' records (no "Type" field found - all records included)']}),e.jsx("br",{}),e.jsxs("span",{className:"text-green-600",children:["Found fields: ",t.availableFields.join(", ")]}),t.missingFields.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("span",{className:"text-red-600",children:["Missing fields: ",t.missingFields.join(", ")]})]})]})]},r))})]}),o.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-900 mb-4 flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 mr-2"}),"Name Duplicates Found"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:o.map((t,r)=>e.jsxs("div",{className:"bg-white p-4 rounded border border-red-200",children:[e.jsxs("div",{className:"font-medium text-red-900 mb-2",children:['Name Duplicate: "',t.originalName||t.duplicateValue,'"']}),e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[t.records.length," records found with the same name"]}),e.jsx("div",{className:"space-y-2",children:t.records.map((s,a)=>e.jsxs("div",{className:"text-xs bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"font-medium",children:["From: ",s.__source_file]}),e.jsx("div",{className:"mt-1",children:Object.entries(s).filter(([l])=>!l.startsWith("__")).slice(0,5).map(([l,d])=>e.jsxs("span",{className:"mr-3",children:[e.jsxs("strong",{children:[l,":"]})," ",String(d)]},l))})]},a))})]},r))})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Preview (First 10 Records)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-xs",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-100",children:u.length>0&&Object.keys(u[0]).filter(t=>!t.startsWith("__")).map(t=>e.jsx("th",{className:"px-2 py-1 text-left font-medium text-gray-700 border",children:t},t))})}),e.jsx("tbody",{children:u.slice(0,10).map((t,r)=>e.jsx("tr",{className:"border-t",children:Object.entries(t).filter(([s])=>!s.startsWith("__")).map(([s,a],l)=>e.jsx("td",{className:"px-2 py-1 border text-gray-600",children:String(a)},l))},r))})]})})]})]})]})};ie.createRoot(document.getElementById("root")).render(e.jsx(te.StrictMode,{children:e.jsx(de,{})}));
